<div id="tabs">
  <?php get_menu($tabsApi); ?>
  <a target="_blank" href="https://riot.js.org/api/misc/">Разное</a>
</div>

<section class="apidoc">

<h1>API · Пользовательские теги</h1>

<div id="toc"><p><a href="#mounting">Монтирование</a></p><p><a href="#rendering">Рендеринг</a></p><p><a href="#tag-instance">Экземпляр тега</a></p><p><a href="#updating">Обновление</a></p><p><a href="#unmounting">Размонтирование</a></p><p><a href="#nested-tags">Вложенные теги</a></p><p><a href="#-yielding-nested-html">Встраивание HTML в тег</a></p><p><a href="#mixins">Примеси</a></p><p><a href="#events">События</a></p><p><a href="#reserved-words">Зарезервированные слова</a></p><p><a href="#manual-construction">Создание тега вручную</a></p></div>

<h2 id="mounting">Монтирование</h2>

<h3 id="-riotmountcustomtagselector-opts">
<a name="mount"></a> riot.mount(customTagSelector, [opts])</h3>

<p><code class="highlighter-rouge">customTagSelector</code> выбирает элементы со страницы и монтирует их как пользовательские теги. Имя выбранного элемента должно совпадать с именем пользовательского тега.</p>

<p><code class="highlighter-rouge">opts</code> - необязательный объект параметров, который передаётся в теги. Это может быть что угодно, начиная от простого объекта до большого API приложения. Или это может быть Flux-хранилище. Это зависит от того, как вы структурируете ваше приложение. Вы можете узнать больше о модульности <a href="guide-design#modularity">здесь</a>. <em>Обратите внимание,</em> что атрибуты монтируемого тега имеют более высокий приоритет над атрибутами, указанными с такими же именами через аргумент <code class="highlighter-rouge">opts</code>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// выбрать и смонтировать все &lt;pricing&gt; теги на странице</span>
<span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'pricing'</span><span class="p">)</span>

<span class="c1">// смонтировать все пользовательские теги с классом .customer</span>
<span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'.customer'</span><span class="p">)</span>

<span class="c1">// смонтировать тег &lt;account&gt; и передать ему объект API в качестве параметра</span>
<span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'account'</span><span class="p">,</span> <span class="nx">api</span><span class="p">)</span>
</code></pre></div></div>

<p>@returns: массив смонтированных <a href="#tag-instance">тегов</a></p>

<p>Примечание: при использовании <a href="guide-compiler#in-browser-compilation">компиляции в браузере</a> необходимо будет обернуть вызовы <code class="highlighter-rouge">riot.mount</code> в <code class="highlighter-rouge">riot.compile</code> для того, чтобы получить возвращаемые <a href="#tag-instance">экземпляры тегов</a>. Без этого, вызовы <code class="highlighter-rouge">riot.mount</code> будут возвращать <code class="highlighter-rouge">undefined</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// здесь теги компилируются и riot.mount работает синхронно</span>
  <span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'*'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<p><span class="tag red">&gt;=3.12.0</span></p>

<p>Аргумент <code class="highlighter-rouge">opts</code> также может быть функцией, чтобы избежать совместного использования одного и того же объекта несколькими экземплярами тегов <a href="https://github.com/riot/riot/issues/2613">riot/2613</a></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'my-tag'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">custom</span><span class="p">:</span> <span class="s1">'option'</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="-riotmount-opts">
<a name="mount-star"></a> riot.mount(‘*’, [opts])</h3>

<p>Специальный селектор Riot “*” используется для монтирования всех пользовательских тегов на странице:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'*'</span><span class="p">)</span>
</code></pre></div></div>

<p>@returns: массив смонтированных <a href="#tag-instance">тегов</a></p>

<h3 id="-riotmountselector-tagname-opts">
<a name="mount-tag"></a> riot.mount(selector, tagName, [opts])</h3>

<p>Здесь</p>

<ul>
  <li>
<code class="highlighter-rouge">selector</code> выбирает любой элемент DOM, к которому будет примонтирован тег</li>
  <li>
<code class="highlighter-rouge">tagName</code> указывает имя используемого тега</li>
  <li>
<code class="highlighter-rouge">opts</code> необязательный объект, содержащий параметры</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// монтирует тег "my-tag" в div#main и передаёт в него параметры из объекта api</span>
<span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">'div#main'</span><span class="p">,</span> <span class="s1">'my-tag'</span><span class="p">,</span> <span class="nx">api</span><span class="p">)</span>
</code></pre></div></div>

<p>@returns: массив смонтированных <a href="#tag-instance">тегов</a></p>

<h3 id="-riotmountdomnode-tagname-opts">
<a name="mount-dom"></a> riot.mount(domNode, tagName, [opts])</h3>

<p>Монтирует пользовательский тег tagName в конкретный элемент DOM domNode, передавая необязательный объект с параметрами. Например:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// монтирует тег "users" в элемент #slide и передаёт в него объект api в качестве параметра
riot.mount(document.getElementById('slide'), 'users', api)
</code></pre></div></div>

<p>@returns: массив смонтированных <a href="#tag-instance">тегов</a></p>

<h3 id="-riotunregistertagname">
<a name="unregister"></a> riot.unregister(tagName)</h3>

<p>Отмена регистрации тега, ранее созданного с помощью компилятора или с помощью <code class="highlighter-rouge">riot.tag()</code>
  Этот метод может быть полезен в случае, если вам нужно протестировать ваше приложение и вы хотите создать несколько тегов, используя, например, одно и то же имя.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// создать тестовый тег</span>
<span class="nx">riot</span><span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="s1">'test-tag'</span><span class="p">,</span> <span class="s1">'&lt;p&gt;{ message }&lt;/p&gt;'</span><span class="p">)</span>

<span class="c1">// смонтировать его</span>
<span class="kd">var</span> <span class="nx">tag</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">),</span> <span class="s1">'test-tag'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nx">expect</span><span class="p">(</span><span class="nx">tag</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'p'</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span>

<span class="c1">// отменить регистрацию тега</span>
<span class="nx">riot</span><span class="p">.</span><span class="nx">unregister</span><span class="p">(</span><span class="s1">'test-tag'</span><span class="p">)</span>

<span class="c1">// воссоздать тот же тег, используя другой шаблон</span>
<span class="nx">riot</span><span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="s1">'test-tag'</span><span class="p">,</span> <span class="s1">'&lt;div&gt;{ message }&lt;/div&gt;'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="rendering">Рендеринг</h2>

<h3 id="-riotrendertagname-opts">
<a name="render"></a> riot.render(tagName, [opts])</h3>

<p>Рендерит пользовательский тег в html.<br>
<strong>Доступен только <em>на серверной стороне</em></strong> (Node/io.js). Например:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// рендерим "my-tag" в html
var mytag = require('my-tag')
riot.render(mytag, { foo: 'bar' })
</code></pre></div></div>

<p>@returns: строка html</p>

<h3 id="-riotrequiretagpath-opts">
<a name="mount-dom"></a> riot.require(tagPath, [opts])</h3>
<p>Запрашивает и компилирует теги riot во время выполнения.<br>
  <strong>Доступен только <em>на серверной стороне</em></strong> (Node/io.js).<br>
Он работает как и <code class="highlighter-rouge">require('./my-tag.tag')</code>, но дает вам возможность скомпилировать ваши теги, используя любые <a href="api-compiler#on-server">параметры компилятора</a>. Например, вы можете запросить тег и использовать препроцессор одновременно.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">tag</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./my-tag.jade'</span><span class="p">,</span> <span class="p">{</span> <span class="na">template</span><span class="p">:</span> <span class="s1">'jade'</span> <span class="p">})</span>
</code></pre></div></div>

<p>@returns: имя тега</p>

<h3 id="-riotrenderasynctagname-opts">
<a name="renderasync"></a> riot.renderAsync(tagName, [opts])</h3>

<p>Асинхронно рендерит пользовательский тег в html.<br>
<strong>Доступен только <em>на серверной стороне</em></strong> (Node/io.js).<br>
Этот метод возвращает обещание, которое будет разрешено только тогда, когда ваши теги вызовут событие “ready” во время процесса монтирования. Например:</p>

<h4 id="on-the-server">На сервере:</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">renderAsync</span><span class="p">(</span><span class="nx">tagName</span><span class="p">,</span> <span class="nx">opts</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// делает что-то с вашим html</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Ошибка времени выполения!</span>
  <span class="p">})</span>
</code></pre></div></div>

<h4 id="in-your-tag">Ваш тег:</h4>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;async-rendering&gt;</span>
  <span class="nt">&lt;p&gt;</span>{ message }<span class="nt">&lt;/p&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>

    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// запуск события "ready" если обещание разрешено</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'ready'</span><span class="p">)</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">500</span><span class="p">)</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/async-rendering&gt;</span>
</code></pre></div></div>

<p>Важно отметить, что если событие “ready” не будет запущено, обещание будет отклонено через 1 секунду. Вы можете настроить тайм-аут внутренних обещаний riot, с помощью  <code class="highlighter-rouge">riot.settings.asyncRenderTimeout</code> (по умолчанию 1000ms)</p>

<p>@returns: Обещание (Promise)</p>

<h2 id="tag-instance">Экземпляр тега</h2>

<p>Следующие свойства установлены для каждого экземпляра тега:</p>

<ul>
  <li>
<code class="highlighter-rouge">opts</code> - объект, который передаётся в тег в качестве параметров</li>
  <li>
<code class="highlighter-rouge">refs</code> - элементы DOM для кеширования</li>
  <li>
<code class="highlighter-rouge">parent</code> - родительский тег, если есть</li>
  <li>
<code class="highlighter-rouge">root</code> - корневой элементы DOM, к которому примонтирован тег</li>
  <li>
<code class="highlighter-rouge">tags</code> - вложенные пользовательские теги</li>
</ul>

<p>Вы можете использовать эти свойства как в HTML, так и в JavaScript. Например:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;h3&gt;</span>{ opts.title }<span class="nt">&lt;/h3&gt;</span>

  var title = opts.title
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>Вы можете свободно устанавливать любые данные для экземпляра тега (называемого “контекст”), и они будут доступны в выражениях HTML. Например:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;h3&gt;</span>{ title }<span class="nt">&lt;/h3&gt;</span>

  this.title = opts.title
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>Примечание: если у вас есть глобальные переменные, вы также можете использовать эти ссылки как в HTML, так и в JavaScript-коде:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">.</span><span class="nx">someGlobalVariable</span> <span class="o">=</span> <span class="s1">'Hello!'</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;h3&gt;</span>{ someGlobalVariable }<span class="nt">&lt;/h3&gt;</span>

  var message = someGlobalVariable
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<h2 id="updating">Обновление</h2>

<h3 id="-thisupdate">
<a name="tag-update"></a> this.update()</h3>

<p>Обновляет все выражения в текущем экземпляре тега, а также во всех дочерних элементах. Этот метод вызывается автоматически каждый раз, когда вызывается обработчик события, например, когда пользователь взаимодействует с приложением.</p>

<p>Вы можете отменить автоматическое обновление, установив свойство <code class="highlighter-rouge">preventUpdate = true</code> для вашего объекта события, например:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">{</span> <span class="na">click</span> <span class="err">}</span><span class="nt">&gt;</span>{ message }<span class="nt">&lt;/button&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>

    <span class="nx">click</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventUpdate</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// ваш тег не будет обновляться автоматически</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'goodbye'</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>Riot не обновляет пользовательский интерфейс автоматически, поэтому вам нужно вызвать этот метод вручную. Обычно это происходит после некоторого события, не связанного с пользовательским интерфейсом: после <code class="highlighter-rouge">setTimeout</code>, вызова AJAX или какого-либо события сервера. Например:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">onblur=</span><span class="s">{</span> <span class="na">validate</span> <span class="err">}</span><span class="nt">&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"tooltip"</span> <span class="na">show=</span><span class="s">{</span> <span class="na">error</span> <span class="err">}</span><span class="nt">&gt;</span>{ error }<span class="nt">&lt;/span&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="nx">validate</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/validate/username/'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">username</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error_message</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">error_message</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>В приведенном выше примере, сообщение об ошибке отображается в пользовательском интерфейсе после вызова метода <code class="highlighter-rouge">update()</code>. (Мы можем продолжать использовать <code class="highlighter-rouge">this</code> ссылаясь на наш экземпляра тега, потому что мы использовали метод <code class="highlighter-rouge">.bind(this)</code> для обработчика <code class="highlighter-rouge">fail</code> ошибок.)</p>

<p>Если вы хотите больше контролировать обновления тегов DOM, вы можете установить пользовательскую функцию <code class="highlighter-rouge">shouldUpdate</code>, и ваш тег будет обновляться только в том случае, если эта функция вернёт <code class="highlighter-rouge">true</code></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">{</span> <span class="na">click</span> <span class="err">}</span><span class="nt">&gt;</span>{ message }<span class="nt">&lt;/button&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>

    <span class="nx">click</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'goodbye'</span>
    <span class="p">}</span>
    <span class="c1">// первый параметр, это данные, которые вы передаёте в метод обновления</span>
    <span class="c1">// при вызове this.update(), он будет иметь значение undefined</span>
    <span class="nx">shouldUpdate</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">nextOpts</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// не обновлять</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="s1">'goodbye'</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span>
      <span class="c1">// если this.message отличается от 'goodbye', то мы можем обновить тег</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>Метод <code class="highlighter-rouge">shouldUpdate</code> всегда получает 2 аргумента: первый из них содержит значения , которые вы хотите обновить с помощью метода <code class="highlighter-rouge">tag.update</code>, а второй аргумент содержит новые параметры, полученные с помощью атрибутов тегов и, как правило, хранящиеся в объекте<code class="highlighter-rouge">opts</code>.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;child-tag</span> <span class="na">message=</span><span class="s">{</span> <span class="na">message</span> <span class="err">}</span><span class="nt">&gt;&lt;/child-tag&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">{</span> <span class="na">click</span> <span class="err">}</span><span class="nt">&gt;</span>Say goodbye<span class="nt">&lt;/button&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>

    <span class="nx">click</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'goodbye'</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>

<span class="nt">&lt;child-tag&gt;</span>
  <span class="nt">&lt;p&gt;</span>{ opts.message }<span class="nt">&lt;/p&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="nx">shouldUpdate</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">nextOpts</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// обновить DOM в зависимости от полученных параметров</span>
      <span class="k">return</span> <span class="nx">nextOpts</span><span class="p">.</span><span class="nx">message</span> <span class="o">!==</span> <span class="s1">'goodbye'</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/child-tag&gt;</span>
</code></pre></div></div>

<h3 id="-thisupdatedata">
<a name="tag-update-data"></a> this.update(data)</h3>

<p>Устанавливает значения свойств текущего элемента и обновляет выражения. Равнозначен <code class="highlighter-rouge">this.update()</code>, но позволяет вам одновременно передавать контекстные данные. Например, вместо этого:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">error_message</span>
<span class="nb">self</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
</code></pre></div></div>

<p>вы можете сделать так:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">self</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span> <span class="na">error</span><span class="p">:</span> <span class="nx">error_message</span> <span class="p">})</span>
</code></pre></div></div>

<p>что выглядит чище и короче.</p>

<h3 id="-riotupdate">
<a name="update"></a> riot.update()</h3>

<p>Обновляет все смонтированные теги и их выражения на странице.</p>

<p>@returns: массив <a href="#tag-instance">тегов</a>, которые смонтированы на странице.</p>

<h2 id="unmounting">Размонтирование</h2>

<h3 id="-thisunmountkeeptheparent">
<a name="tag-unmount"></a> this.unmount(keepTheParent)</h3>

<p>Отсоединяет тег и его дочерние элементы от страницы и запускает событие “unmount”.
Если вы хотите размонтировать тег без удаления родительского тега, вам нужно передать параметр <code class="highlighter-rouge">true</code> при вызове этого метода.</p>

<p>Удаляет тег из DOM:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">mytag</span><span class="p">.</span><span class="nx">unmount</span><span class="p">()</span>
</code></pre></div></div>

<p>Удаляет всех потомков и оставляет только родительский тег:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">mytag</span><span class="p">.</span><span class="nx">unmount</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</code></pre></div></div>
<!-- закладка -->
<h2 id="nested-tags">Вложенные теги</h2>

<p>You have access to nested tag instances via <code class="highlighter-rouge">tags</code> variable:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>

  <span class="nt">&lt;child&gt;&lt;/child&gt;</span>
  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mount'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// access to child tag</span>
      <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">child</span>
    <span class="p">})</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>If more than one of the same child tag is used, it is accessed as an array <code class="highlighter-rouge">this.tags.child[n]</code></p>

<p>You can also use the <code class="highlighter-rouge">ref</code> attribute to give another name for the nested tag.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>

  <span class="nt">&lt;child</span> <span class="na">ref=</span><span class="s">"my_nested_tag"</span><span class="nt">&gt;&lt;/child&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mount'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// access to child tag</span>
      <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">my_nested_tag</span>
    <span class="p">})</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<p>The child tags are initialized after the parent tag so the methods and properties are available on the “mount” event.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-tag&gt;</span>

  <span class="nt">&lt;child</span> <span class="na">ref=</span><span class="s">"my_nested_tag"</span><span class="nt">&gt;&lt;/child&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="c1">// access to child tag methods</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mount'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">my_nested_tag</span><span class="p">.</span><span class="nx">someMethod</span><span class="p">()</span>
      <span class="c1">// this.tags.child.someMethod() is also valid</span>
    <span class="p">})</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<h2 id="-yielding-nested-html">
<a name="yield"></a> Yielding nested HTML</h2>

<p>The <code class="highlighter-rouge">&lt;yield&gt;</code> tag is a special riot core feature that allows you to inject and compile the content of any custom tag inside its template in runtime.
For example using the following riot tag <code class="highlighter-rouge">my-post</code></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-post&gt;</span>
  <span class="nt">&lt;h1&gt;</span>{ opts.title }<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;yield/&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="mi">666</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-post&gt;</span>
</code></pre></div></div>

<p>anytime you will include the <code class="highlighter-rouge">&lt;my-post&gt;</code> tag in your app</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-post</span> <span class="na">title=</span><span class="s">"What a great title"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">id=</span><span class="s">"my-content-{ id }"</span><span class="nt">&gt;</span>My beautiful post is just awesome<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/my-post&gt;</span>
</code></pre></div></div>

<p>once mounted <code class="highlighter-rouge">riot.mount('my-post')</code> it will be rendered in this way:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-post&gt;</span>
  <span class="nt">&lt;h1&gt;</span>What a great title<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">id=</span><span class="s">"my-content-666"</span><span class="nt">&gt;</span>My beautiful post is just awesome<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/my-post&gt;</span>
</code></pre></div></div>

<p><span class="tag red">Warning</span> The yielded expressions <strong>will be always evaluated from the context where they will be included</strong> for example</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- This tag just inherits the yielded DOM --&gt;</span>
<span class="nt">&lt;child-tag&gt;&lt;yield/&gt;&lt;/child-tag&gt;</span>

<span class="nt">&lt;my-tag&gt;</span>
  <span class="nt">&lt;child-tag&gt;</span>
    <span class="nt">&lt;p&gt;</span>{ parent.message }<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/child-tag&gt;</span>
  <span class="nt">&lt;script&gt;</span>
    <span class="c1">// notice that the yielded markup points to the parent.message</span>
    <span class="c1">// { message } is wrong here because it's evaluated under the </span><span class="o">&lt;</span><span class="nx">child</span><span class="o">-</span><span class="nx">tag</span><span class="o">&gt;</span> <span class="nx">context</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/my-tag&gt;</span>
</code></pre></div></div>

<h4 id="multi-transclusion">Multi-Transclusion</h4>

<p>The <code class="highlighter-rouge">&lt;yield&gt;</code> tag also provides a slot mechanism that allows you to inject html contents on specific slots in the template</p>

<p>For example using the following riot tag <code class="highlighter-rouge">my-other-post</code></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-other-post&gt;</span>
  <span class="nt">&lt;article&gt;</span>
    <span class="nt">&lt;h1&gt;</span>{ opts.title }<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;h2&gt;&lt;yield</span> <span class="na">from=</span><span class="s">"summary"</span><span class="nt">/&gt;&lt;/h2&gt;</span>
    <span class="nt">&lt;div&gt;</span>
      <span class="nt">&lt;yield</span> <span class="na">from=</span><span class="s">"content"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/article&gt;</span>
<span class="nt">&lt;/my-other-post&gt;</span>
</code></pre></div></div>

<p>anytime you will include the <code class="highlighter-rouge">&lt;my-other-post&gt;</code> tag in your app</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-other-post</span> <span class="na">title=</span><span class="s">"What a great title"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;yield</span> <span class="na">to=</span><span class="s">"summary"</span><span class="nt">&gt;</span>
    My beautiful post is just awesome
  <span class="nt">&lt;/yield&gt;</span>
  <span class="nt">&lt;yield</span> <span class="na">to=</span><span class="s">"content"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>And the next paragraph describes just how awesome it is<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>Very<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/yield&gt;</span>
<span class="nt">&lt;/my-other-post&gt;</span>
</code></pre></div></div>

<p>once mounted <code class="highlighter-rouge">riot.mount('my-other-post')</code> it will be rendered in this way:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;my-other-post&gt;</span>
  <span class="nt">&lt;article&gt;</span>
    <span class="nt">&lt;h1&gt;</span>What a great title<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;h2&gt;</span>My beautiful post is just awesome<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;div&gt;</span>
      <span class="nt">&lt;p&gt;</span>And the next paragraph describes just how awesome it is<span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;p&gt;</span>Very<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/article&gt;</span>
<span class="nt">&lt;/my-other-post&gt;</span>
</code></pre></div></div>

<h4 id="yield-and-loops">Yield and loops</h4>

<p>The <code class="highlighter-rouge">&lt;yield&gt;</code> tag could be used also in a loop or in a child tag but you should be aware that <strong>it will be always parsed and compiled using the child data</strong></p>

<p>The following <code class="highlighter-rouge">blog.tag</code> riot component</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;blog&gt;</span>
  <span class="nt">&lt;h1&gt;</span>{ title }<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;my-post</span> <span class="na">each=</span><span class="s">{</span> <span class="na">posts</span> <span class="err">}</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">{</span> <span class="na">this</span><span class="err">.</span><span class="na">parent</span><span class="err">.</span><span class="na">backToHome</span> <span class="err">}</span><span class="nt">&gt;</span>Back to home<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">onclick=</span><span class="s">{</span> <span class="na">this</span><span class="err">.</span><span class="na">parent</span><span class="err">.</span><span class="na">deleteAllPosts</span> <span class="err">}</span><span class="nt">&gt;</span>Delete all the posts<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/my-post&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">backToHome</span> <span class="o">=</span> <span class="s1">'/homepage'</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">'my blog title'</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s2">"post 1"</span><span class="p">,</span> <span class="na">description</span><span class="p">:</span> <span class="s1">'my post description'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s2">"post 2"</span><span class="p">,</span> <span class="na">description</span><span class="p">:</span> <span class="s1">'my post description'</span> <span class="p">}</span>
    <span class="p">]</span>

    <span class="c1">// the bind is needed in this case to keep the parent context</span>
    <span class="c1">// also in the child tags</span>
    <span class="nx">deleteAllPosts</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="c1">// we need to trigger manually the update function</span>
      <span class="c1">// because this function gets triggered from a child tag</span>
      <span class="c1">// and it does not bubble up automatically</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/blog&gt;</span>

<span class="nt">&lt;my-post&gt;</span>
  <span class="nt">&lt;h2&gt;</span>{ title }<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;p&gt;</span>{ description }<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;yield/&gt;</span>
<span class="nt">&lt;/my-post&gt;</span>
</code></pre></div></div>

<p>will be compiled in this way:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;blog&gt;</span>
  <span class="nt">&lt;h1&gt;</span>my blog title<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;my-post&gt;</span>
    <span class="nt">&lt;h2&gt;</span>post 1<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;p&gt;</span>my post description<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/homepage"</span><span class="nt">&gt;</span>Back to home<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;div&gt;</span>Delete all the posts<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/my-post&gt;</span>
  <span class="nt">&lt;my-post&gt;</span>
    <span class="nt">&lt;h2&gt;</span>post 2<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;p&gt;</span>my post description<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/homepage"</span><span class="nt">&gt;</span>Back to home<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;div&gt;</span>Delete all the posts<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/my-post&gt;</span>
<span class="nt">&lt;/blog&gt;</span>
</code></pre></div></div>

<h2 id="mixins">Mixins</h2>

<h3 id="-thismixinmixinobject">
<a name="mixin"></a> this.mixin(mixinObject)</h3>

<p>Extends the current tag with functionality available on mixinObject. For example:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">OptsMixin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// init method is a special one which can initialize</span>
  <span class="c1">// the mixin when it's loaded to the tag and is not</span>
  <span class="c1">// accessible from the tag its mixed in</span>
  <span class="c1">// `opts` here is the option object received by the tag as well</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'updated'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Updated!'</span><span class="p">)</span> <span class="p">})</span>
  <span class="p">},</span>

  <span class="na">getOpts</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">opts</span>
  <span class="p">},</span>

  <span class="na">setOpts</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">update</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">opts</span> <span class="o">=</span> <span class="nx">opts</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">update</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
    <span class="k">return</span> <span class="k">this</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="o">&lt;</span><span class="nx">my</span><span class="o">-</span><span class="nx">tag</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">title</span> <span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="nx">OptsMixin</span><span class="p">)</span>
<span class="o">&lt;</span><span class="sr">/my-tag</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="-riotmixinmixinname-mixinobject">
<a name="mixin-shared"></a> riot.mixin(mixinName, mixinObject)</h3>

<p>Register a shared mixin, globally available to be used in any tag: <code class="highlighter-rouge">this.mixin(mixinName)</code>.</p>

<h3 id="-riotmixinmixinobject">
<a name="mixin-global"></a> riot.mixin(mixinObject)</h3>

<p>Register a global mixin, and automatically adds it to all tag instances.</p>

<h2 id="events">Events</h2>

<p>Each tag instance is an <a href="./observable">observable</a> so you can use <code class="highlighter-rouge">on</code> and <code class="highlighter-rouge">one</code> methods to listen to the events that happen on the tag instance. Here’s the list of supported events:</p>

<ul>
  <li>“update” – right before the tag is updated. allows recalculation of context data before the UI expressions are updated.</li>
  <li>“updated” – right after the tag is updated. allows do some work with updated DOM</li>
  <li>“before-mount” – right before tag is mounted on the page</li>
  <li>“mount” – right after tag is mounted on the page</li>
  <li>“before-unmount” – before the tag is removed from the page</li>
  <li>“unmount” – after the tag is removed from the page</li>
</ul>

<p>For example:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// cleanup resources after tag is no longer part of DOM</span>
<span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'unmount'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="reserved-words">Reserved words</h2>

<p>The above method and property names are reserved words for Riot tags. Don’t use any of following as your instance variable or method name: <code class="highlighter-rouge">opts</code>, <code class="highlighter-rouge">parent</code>, <code class="highlighter-rouge">tags</code>, <code class="highlighter-rouge">root</code>, <code class="highlighter-rouge">refs</code>, <code class="highlighter-rouge">update</code>, <code class="highlighter-rouge">unmount</code>, <code class="highlighter-rouge">on</code>, <code class="highlighter-rouge">off</code>, <code class="highlighter-rouge">one</code> and <code class="highlighter-rouge">trigger</code>. Variables beginning with an underscore (e.g.: <code class="highlighter-rouge">this._item</code>) are reserved for internal use too. Local variables can be freely named. For example:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">my</span><span class="o">-</span><span class="nx">tag</span><span class="o">&gt;</span>

  <span class="c1">// allowed</span>
  <span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

  <span class="c1">// not allowed</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

  <span class="c1">// not allowed</span>
  <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>

  <span class="p">}</span>

<span class="o">&lt;</span><span class="sr">/my-tag</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="manual-construction">Manual construction</h2>

<h3 id="-riottagtagname-html-css-attrs-constructor">
<a name="tag"></a> riot.tag(tagName, html, [css], [attrs], [constructor])</h3>

<p>Creates a new custom tag “manually” without the compiler.</p>

<ul>
  <li>
<code class="highlighter-rouge">tagName</code> the tag name</li>
  <li>
<code class="highlighter-rouge">html</code> is the layout with <a href="/guide/#expressions">expressions</a>
</li>
  <li>
<code class="highlighter-rouge">css</code> is the style for the tag (optional)</li>
  <li>
<code class="highlighter-rouge">attrs</code> string of attributes for the tag (optional).</li>
  <li>
<code class="highlighter-rouge">constructor</code> is the initialization function being called before the tag expressions are calculated and before the tag is mounted</li>
</ul>

<h4 id="example">Example</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="s1">'timer'</span><span class="p">,</span>
  <span class="s1">'&lt;p&gt;Seconds Elapsed: { time }&lt;/p&gt;'</span><span class="p">,</span>
  <span class="s1">'timer { display: block; border: 2px }'</span><span class="p">,</span>
  <span class="s1">'class="tic-toc"'</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nb">self</span> <span class="o">=</span> <span class="k">this</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">start</span> <span class="o">||</span> <span class="mi">0</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nb">self</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span> <span class="na">time</span><span class="p">:</span> <span class="o">++</span><span class="nb">self</span><span class="p">.</span><span class="nx">time</span> <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tick</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'unmount'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
    <span class="p">})</span>

  <span class="p">})</span>
</code></pre></div></div>

<p>See <a href="http://jsfiddle.net/gnumanth/h9kuozp5/">timer demo</a> and <a href="/api/#tag-instance">riot.tag</a> API docs for more details and <em>limitations</em>.</p>

<p><span class="tag red">Warning</span> by using <code class="highlighter-rouge">riot.tag</code> you cannot enjoy the advantages of the compiler and the following features are not supported:</p>

<ol>
  <li>Self-closing tags</li>
  <li>Unquoted expressions. Write <code class="highlighter-rouge">attr="{ val }"</code> instead of <code class="highlighter-rouge">attr={ val }</code>
</li>
  <li>Shorthand ES6 method signatures</li>
  <li>
<code class="highlighter-rouge">&lt;img src={ src }&gt;</code> must be written as <code class="highlighter-rouge">&lt;img riot-src={ src }&gt;</code> in order to avoid illegal server requests</li>
  <li>
<code class="highlighter-rouge">&lt;input value={ val }&gt;</code> must be written as <code class="highlighter-rouge">&lt;img riot-value={ val }&gt;</code> in order to avoid unexpected IE issues</li>
  <li>
<code class="highlighter-rouge">style="color: { color }"</code> must be written as <code class="highlighter-rouge">riot-style="color: { color }"</code> so that style attribute expressions work in IE</li>
  <li>Scoped CSS precompilation.</li>
</ol>

<p>You can take advantage of <code class="highlighter-rouge">&lt;template&gt;</code> or <code class="highlighter-rouge">&lt;script&gt;</code> tags as follows:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"tmpl"</span> <span class="na">id=</span><span class="s">"my_tmpl"</span><span class="nt">&gt;</span>
  <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="p">{</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">hello</span> <span class="p">}</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">And</span> <span class="nx">a</span> <span class="nx">paragraph</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span><span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="nx">riot</span><span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="s1">'tag-name'</span><span class="p">,</span> <span class="nx">my_tmpl</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>

<span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<h4 id="tags-without-template">Tags without template</h4>

<p><span class="tag red">&gt;=3.5.0</span></p>

<p>Starting from riot 3.5 you can also create “wrapper tags” without any template as follows:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">riot</span><span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="s1">'tag-name'</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hi'</span>
<span class="p">})</span>

</code></pre></div></div>

<p>In this case anytime you will mount a tag named <code class="highlighter-rouge">tag-name</code> riot will leave the tag markup untouched parsing and rendering only the expressions contained in it:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;tag-name&gt;</span>
    <span class="nt">&lt;p&gt;</span>I want to say { message }<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/tag-name&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>This technique might be used to enhance serverside rendered templates.
It will allow you also creating new tags composition patterns wrapping logic agnostic children components communicating with wrapper tags where you can handle your application logic:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form-validator&gt;</span>
  <span class="nt">&lt;date-picker</span> <span class="na">onchange=</span><span class="s">{</span> <span class="na">updateDate</span> <span class="err">}</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;color-picker</span> <span class="na">onchange=</span><span class="s">{</span> <span class="na">pickAColor</span> <span class="err">}</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;errors-reporter</span> <span class="na">if=</span><span class="s">{</span> <span class="na">errors</span><span class="err">.</span><span class="na">length</span> <span class="err">}</span> <span class="na">errors=</span><span class="s">{</span> <span class="na">errors</span> <span class="err">}</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form-validator&gt;</span>
</code></pre></div></div>

<h3 id="riottagel-opts">riot.Tag(el, [opts])</h3>

<p>The riot.Tag constructor will allow you to create and extend your tags using <code class="highlighter-rouge">es6</code> classes.
If you want to create your riot tag you need to extend the <code class="highlighter-rouge">riot.Tag</code> constructor:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyTag</span> <span class="kd">extends</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">Tag</span> <span class="p">{</span>
  <span class="c1">// mandatory in order to use and identify this component</span>
  <span class="kd">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'my-tag'</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">tmpl</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`&lt;p onclick="{ click }"&gt;{ message }, Dear user&lt;/p&gt;`</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">attrs</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'class="{ className }"'</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">css</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'my-tag p{ color: blue; }'</span>
  <span class="p">}</span>
  <span class="nx">onCreate</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">message</span>
  <span class="p">}</span>
  <span class="nx">click</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'goodbye'</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">MyTag</span><span class="p">(</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'my-div'</span><span class="p">),</span>
  <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="s1">'hi'</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">mount</span><span class="p">()</span>
</code></pre></div></div>

<p>You can also combine your riot tags extending them starting from a common ancestor</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Logger</span> <span class="kd">extends</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">Tag</span> <span class="p">{</span>
  <span class="kd">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'logger'</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">tmpl</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`&lt;div&gt;{ opts.log }&lt;/div&gt;`</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">ErrorLogger</span> <span class="kd">extends</span> <span class="nx">Logger</span> <span class="p">{</span>
  <span class="kd">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'error-logger'</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">css</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'error-logger div { color: red; }'</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">SuccessLogger</span> <span class="kd">extends</span> <span class="nx">Logger</span> <span class="p">{</span>
  <span class="kd">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'success-logger'</span>
  <span class="p">}</span>
  <span class="kd">get</span> <span class="nx">css</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'success-logger div { color: green; }'</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">ErrorLogger</span><span class="p">(</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.error'</span><span class="p">),</span>
  <span class="p">{</span> <span class="na">log</span><span class="p">:</span> <span class="s1">'oups!!!'</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">mount</span><span class="p">()</span>

<span class="k">new</span> <span class="nx">SuccessLogger</span><span class="p">(</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.success'</span><span class="p">),</span>
  <span class="p">{</span> <span class="na">log</span><span class="p">:</span> <span class="s1">'well done!!!'</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">mount</span><span class="p">()</span>
</code></pre></div></div>

</section>